<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{common/layouts/account_layout}"
      layout:fragment="Content">
  <head>
    <meta charset="UTF-8" />
<title>전자세금계산서</title>
    <style>
      body {
        font-size: 18px;
      }
      /* 스크롤 가능한 테이블 컨테이너 */
      .scrollable-table-container {
        max-height: 400px; /* 세로 최대 높이 설정 */
        overflow-y: auto; /* 세로 스크롤 활성화 */
        overflow-x: auto; /* 가로 스크롤 활성화 */
        margin-bottom: 10px; /* 버튼과 테이블 사이 간격 */
        width: 100%; /* 화면 크기에 따라 너비를 조정 */
      }

      /* 테이블의 폭을 고정하지 않고, 내용에 맞게 너비가 줄어들도록 설정 */
      .table {
        min-width: 1000px; /* 테이블의 최소 너비 설정 */
        width: 100%;
        white-space: nowrap; /* 자동 줄바꿈 방지 */
        text-align: center;
      }

      /* 버튼 고정 */
      .button-group {
        display: flex;
        gap: 5px; /* 버튼들 사이 간격 */
        font-size: 18px;
        margin-top:20px;
        margin-bottom:10px;
        justify-content: flex-end; /* 버튼을 왼쪽에 정렬 */
      }

      .status-count {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
      }
      .status-item {
        border: 1px solid #dee2e6;
        padding: 8px 15px;
        border-radius: 4px;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .progress-dots {
        display: flex;
        gap: 3px;
      }
      .dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background-color: #dee2e6;
      }
      .dot.active {
        background-color: #0d6efd;
      }
      .table {
        white-space: nowrap;
        font-size: 18px;
      }
      .table thead th{
    	font-size: 1rem; 
  }
      .table th {
        background-color: #f8f9fa;
        font-weight: 500;
      }
      .btn {
        padding: 4px 8px;
      }
      .search-bar {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 20px;
      }
      .action-link {
        color: #0d6efd;
        text-decoration: none;
      }
      .action-link:hover {
        text-decoration: underline;
      }

      .status-count {
        background-color: #f8f9fa;
        padding: 10px;
        border-radius: 4px;
        margin-bottom: 1rem;
      }

      .status-box {
        text-align: center;
        padding: 8px;
        border-right: 1px solid #dee2e6;
      }

      .status-box:last-child {
        border-right: none;
      }

      .status-number {
        font-size: 1.4rem;
        font-weight: bold;
        color: #31ce36;
      }

      .status-label {
        font-size: 1.2rem;
        color: #6c757d;
      }
    </style>
  </head>
  <body>
    <div class="container-fluid p-4">
    
      <!-- Search Bar -->
      <!--  
      <div class="search-bar d-flex justify-content-end">
        <input
          type="text"
          class="form-control"
          style="width: 200px"
          placeholder="검색어 입력"
        />
        <button class="btn btn-success">Search(F3)</button>
        <button class="btn btn-secondary">Option</button>
      </div>
      -->
      
      <!-- Status Counters -->
      <div class="row status-count">
        <div class="col status-box">
          <div class="status-number">6</div>
          <div class="status-label">전체</div>
        </div>
        <div class="col status-box">
          <div class="status-number">0</div>
          <div class="status-label">전송중</div>
        </div>
        <div class="col status-box">
          <div class="status-number">5</div>
          <div class="status-label">전송완료</div>
        </div>
        <!-- Add more status boxes as needed -->
      </div>

      <!--
      <div class="status-count">
        <div class="status-item">
          <span>전체</span>
          <span class="status-number">9</span>
        </div>
        <div class="status-item">
          <span>전송오류</span>
          <span class="status-number">0</span>
        </div>
        <div class="status-item">
          <span>확부전</span>
          <span class="status-number">9</span>
        </div>
        <div class="status-item">
          <span>확부중</span>
          <span class="status-number">0</span>
        </div>
      </div>
    -->
      <!-- 버튼들이 고정된 위치에 나타나도록 합니다. -->
      <div class="button-group">
        <button class="btn btn-success">전송</button>
        <button class="btn btn-secondary">인쇄</button>
        <button class="btn btn-secondary">Excel</button>
      </div>

      <!-- Main Table -->
       <div id="grid"></div>
  	   <div id="pagination" class="tui-pagination"></div> <!-- 페이징 ui -->
  
      
      </div>
    <script>
    
    // Grid 데이터 정의
    const gridData = [
      {
        date: '2024/11/10',
        clientName: '김치좋아',
        supplyAmount: 100000,
        vat: 10000,
        totalAmount: 110000,
        taxProgress: '완료',
      },
      // 추가 데이터는 여기 삽입
    ];

	  const grid = new tui.Grid({
	    el: document.querySelector('#grid'),
	    data: gridData,
	    scrollX: true,
	    scrollY: true,
	    pageOptions: {
	      useClient: true,
	      perPage: 5,
	    },
	    columns: [
	        {
	          header: '일자',
	          name: 'date',
	          sortable: true,
	       
	          align: 'center',
	        },
	        {
	          header: '거래처명',
	          name: 'clientName',
	          sortable: true,
	         
	          align: 'left',
	        },
	        {
	          header: '공급가액',
	          name: 'supplyAmount',
	          sortable: true,
	       
	          align: 'right',
	          formatter: 'number', // 숫자 형식으로 표시
	        },
	        {
	          header: '부가세',
	          name: 'vat',
	          sortable: true,
	         
	          align: 'right',
	          formatter: 'number',
	        },
	        {
	          header: '합계금액',
	          name: 'totalAmount',
	          sortable: true,
	         
	          align: 'right',
	          formatter: 'number',
	        },
	        {
	          header: '전자세금계산서 진행단계',
	          name: 'taxProgress',
	          sortable: true,
	         
	          align: 'center',
	        },],
	    rowHeaders: ['rowNum', 'checkbox'],
	  });

	  grid.on('click', (event) => {
	    if (event.columnName === 'debentureNo' && event.rowKey >= 0) {
	      console.log('클릭이벤트 발생');
	      console.log(event.rowKey);
	    }
	  });
	  
    
      // 체크박스
      function toggleAllCheckboxes(source) {
        const checkboxes = document.querySelectorAll(".row-checkbox");
        checkboxes.forEach((checkbox) => (checkbox.checked = source.checked));
      }

      // 전체, 미전송, 전송완료
      document.addEventListener("DOMContentLoaded", function () {
        const statusBoxes = document.querySelectorAll(".status-box");

        statusBoxes.forEach((box) => {
          box.addEventListener("click", function () {
            const status = box.querySelector(".status-label").textContent;
            filterByStatus(status);
          });
        });

        function filterByStatus(status) {
          console.log(`${status} 상태의 데이터만 표시합니다.`);
          // 실제 필터링 로직을 추가하여 테이블이나 데이터를 갱신할 수 있습니다.
        }
      });

      document.addEventListener("DOMContentLoaded", function () {
        // Search functionality
        const searchInput = document.querySelector('input[type="text"]');
        const searchButton = document.querySelector(".btn-primary");

        searchButton.addEventListener("click", function () {
          performSearch(searchInput.value);
        });

        // F3 shortcut for search
        document.addEventListener("keydown", function (e) {
          if (e.key === "F3") {
            e.preventDefault();
            performSearch(searchInput.value);
          }
        });

        function performSearch(query) {
          // Implement search logic here
          console.log("Searching for:", query);
        }

        // Format numbers
        document.querySelectorAll(".text-end").forEach((cell) => {
          const value = cell.textContent;
          if (value && !isNaN(value.replace(/,/g, ""))) {
            cell.textContent = Number(value.replace(/,/g, "")).toLocaleString(
              "ko-KR"
            );
          }
        });
      });
    </script>
  </body>
</html>
