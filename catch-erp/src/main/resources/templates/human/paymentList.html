<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{common/layouts/human_layout}"
      layout:fragment="Content">
<head>
<meta charset="UTF-8">
<style>
        body {
            font-size: 0.85rem;
        }
        .container-fluid {
            max-width: 1200px;
        }
        .employee-list, .employee-form {
            height: 500px;
            overflow-y: auto;
        }
        .employee-photo {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 50%;
        }
        .form-control, .form-select, .btn {
            font-size: 0.8rem;
        }
        .table {
            font-size: 0.85rem;
        }
        .card {
            border: none;
            box-shadow: none;
        }
        .form-label {
            margin-bottom: 0.25rem;
        }
		.table>tbody>tr>td, .table>tbody>tr>th, .table thead th {
		    padding: 0px 0px 4px 24px !important;
		   	font-size:14px;
		}
		.container .table-head thead tr th{
			background-color:#aacb73 !important;
		}
		.scroll-bar{
			overflow-x:auto ;
			overflow-y:auto ;
		
		}
		.scroll-table{
		
			min-width:1500px ;
			min-height:200px;
			max-height:400px ;
			
		}
		.scroll-table table thead tr th {
			padding:8px !important;
			padding-left:8px !important;
			padding-right:8px !important;
			text-align:center;
		}
		.scroll-table table tbody tr td {
			padding:8px !important;
			padding-left:8px !important;
			padding-right:8px !important;
			border:1px #ccc solid;
	
		}
		td input[type='text'] {
			width:100%;
			border:0;
			
		}
		input[type='month'] {
			border:1px solid black;
			border-radius:2px;
		}
		.scroll-x {
			overflow:auto;
		}
		#payrollPrintModal table {
		  width:800px;
		  
		
		}
		#payrollPrintModal table, td, th {
		border : 2px solid black;
		border-collapse : collapse;
		text-align: center;
		padding:8px;
		}
		#payrollPrintModal table {
		border: 3px solid black;
		}
		#payrollPrintModal .background-payment{
		background-color: rgb(216, 216, 216);
		font-weight: 500;
		}
		#payrollPrintModal .bold-color {
		background-color:rgb(20, 78, 38);
		font-size: large;
		color:white;
		}
		#payrollPrintModal tfoot {
		border-top: 3px solid black;
		
		}
		#payrollPrintModal .modal-body  {
		margin:0 auto;}

</style>
<title>Insert title here</title>
</head>
<body>
	<div class="container-fluid p-4 bg-white">
		<div class="row"> <!-- start first row -->
        <!--  세부 검색 구역 -->
      <div class="card mb-4 bg-white">
        <div class="card-body bg-light">
        <h3>급여정보</h3>
          <form>
          	<!-- 1행 시작 (화면 작아질시 두줄로 변환)-->
            <div class="row mb-3 align-items-center row-gap-3">
            <!-- 직위/직급 -->
              <div class="col-md-6"><!-- 크기가 sm으로 변환시 한줄 전체차지 -->
                <div class="row align-items-center">
                	<div class="col-auto  pe-0">
            	      <label class="form-label me-1 mb-0 label-width">직위/직급</label>
                  	</div>
                  	<div class="col align-self-start ps-0">
                  		<select class="form-select input-width-120 search-option " name="employeePosition">
                    		<option value="">전체</option>
                    		<th:block th:each="com : ${comList}">
                    			<option  th:if="${com.commonCode eq '0H'}" th:value="${com.codeRule}" th:text="${com.commonName}"></option>
                    		</th:block>
		                </select>
                  	</div>
                </div>
              </div>
              <!-- 직위/직급 끝-->
              <!-- 사원 -->
              <div class="col">
                <div class="row align-items-center">
                	<div class="col-auto"> <!-- auto로 크기를 줘서 컨텐츠 크기만큼만 너비 차지 -->
                  		<label class="form-label me-2 mb-0 label-width">사원</label>
                  	</div>
                  	<div class="col">
                  		<input type="text" class="form-control input-width-120 me-2 search-option" name="employeeId" placeholder="사원" />
					</div>
                </div>
              </div>
              <!-- 사원끝 -->
            </div>
			<!-- 2행 시작 -->
            <div class="row align-items-center mb-3">
            	<!-- 부서칸-->
            	<div class="col-sm-5 ">
              		<div class="row align-items-center">
              			<div class="col-auto">
                  			<label class="form-label me-2 mb-0 label-width">부서</label>
                  		</div>
                		<div class="col">
		                	<select class="form-select input-width-150 search-option" name="departmentCode">
		                		<option value="">전체</option>
                    		<th:block th:each="dept : ${deptList}">
                    			<option   th:value="${dept.departmentCode}" th:text="${dept.departmentName}"></option>
                    		</th:block>
		                 	</select>
	                 	</div>
    	            </div>
              	</div>
              	<!-- 부서칸 끝! -->
              	<!-- 재직구분칸 시작! -->
              	<div class=" col-sm-7 ">
              		<!-- 라벨(재직구분)만 auto로 컨텐츠크기만 차지하게하고, 나머지 라디오버튼(라벨포함)에 대해서는 남는부분을 3등분 시켜 동일한 크기를 지니게함 -->
              		<div class="row align-items-center">
              			<div class="col-auto">
                  			<label class="form-label me-2 mb-0 label-width ">재직구분</label>
                  		</div>
                  		<div class="col">
                    		<input class="form-check-input search-option1" type="radio" name="statusType" id="status2" value="m1" />
                    		<label  for="status2">재직</label>
                  		</div>
                  		<div class="col">
                    		<input class="form-check-input" type="radio" name="statusType" id="status3" value="m2" />
                    		<label  for="status3">휴직</label>
                  		</div>
                    	<div class="col">
                    		<input class="form-check-input" type="radio" name="statusType" id="status3" value="m3" />
                    		<label  for="status3">퇴직</label>
                  		</div>
                	</div>
              	</div>
              	<!-- 재직구분칸끝!! -->
            </div>
			<!-- 2행끝 (크기바뀌면 2행이아니라 각자 한줄임)-->
			<!-- 3행시작 -->
			<!--   날짜칸 시작 lg이하에서는 두줄로 표시하게 바꿈-->
            <div class="row mb-3 align-items-center row-gap-3">
            	<div class="col-lg-7 ">
                	<label class="form-label me-2 mb-0 label-width">입사일자</label>
                    <input type="date" class="search-option" name="hireDateStart">
                    <!-- &nbsp;는 공백(띄워쓰기)임 -->
                    <span class="me-2">&nbsp;&nbsp;&nbsp;~&nbsp;</span>
                  	<input type="date" class="search-option" name="hireDateEnd">
               	</div>
              	<div class="col-auto">                    
                	<label class="form-label me-2 mb-0 label-width">퇴사일자</label>
                  	<input type="date" class="search-option" name="resignationDateStart">
                    <span class="me-2">&nbsp;&nbsp;&nbsp;~&nbsp;</span>
                  	<input type="date" class="search-option" name="resingationDateEnd">                    
              	</div>
            </div>
            <!-- 날짜칸끝 -->
            <!-- 4행 시작 -->
            <!-- between으로 각 콘텐츠를 양끝에둠 -->
            <div class="row justify-content-between  mb-2">
           		<div class="col-xl">
	           		<div class="row ">
              	  		<div class="col-auto ">
                  			<label class="form-label me-2 mb-0 label-width">성명</label>
                  		</div>
                  		<div class="col-8 col-lg-6">
                  			<input type="text" class="form-control input-width-200 search-option" name="employeeName" placeholder="성명" />
                  		</div>
                  	</div>
                 </div>
                 <div class="col"> 	
                  	<div class="row">
		              	<div class="col-auto">                    
 			               	<label class="form-label me-2 mb-0 label-width">근태일자</label>
    		              	<input type="month" class="search-option" name="payrollYStart">
  		  	                <span class="me-2">&nbsp;&nbsp;&nbsp;~&nbsp;</span>
        		          	<input type="month" class="search-option" name="payrollYEnd">                    
    		          	</div>
                  	</div>
                </div>
            </div>
            <!-- 4행끝 -->
            <div class="row justify-content-end">
                <div class="col-auto row justify-content-end">
                	<div class="col">
                        <button type="button" class="btn btn-primary search-btn">검색</button>
                    </div>
                </div>
            </div>
          </form>
        </div>
      </div>
			<!--  세부 검색 구역 끝!!!! -->
		</div> <!-- end first row -->
		<div class="row justify-content-end">
			<div class="col-auto">
				<span class="payrolldate">2024.01</span>
			</div>
		
		</div>
			<!-- 버튼용 로우 -->
			<div class="row justify-content-between mb-2">
				<div class="col-auto">
					<div class="row">
						<div class="col-auto">
							<button type="button" class="btn btn-sm btn-danger delete-Btn">삭제</button>
						</div>
					</div>
				</div>
				<div class="col-auto">
					<div class="row">
						<div class="col">
							<button type="button" class="btn btn-sm btn-secondary">Excel</button>
							<button type="button" class="btn btn-sm btn-secondary">인쇄</button>
						</div>				
					</div>
				</div>
			</div>
		<!-- 급여 테이블시작!!! -->
		<div class="row">
			<div class="col scroll-x">
				<div id="grid"></div>			
			</div>
		</div>
	</div>
	
	<!-- 급여수정내역 모달 -->
    <div class="modal fade" id="salModifyModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">급여내역수정</h5>
                    <div class="action-buttons">
                    </div>
                </div>
                <div class="modal-body">
                    <div class="container-fluid">
                        <!-- 검색창-->
                        <div class="row justify-content-between mb-3">
                            <div class="col-auto">
                                <h4>급여내역수정</h4>
                            </div>
                        </div> <!--검색창끝-->
                        <!--사원테이블-->
                        <div class="row" style="overflow:auto;">
                            <div id="salModifyGrid"></div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary update-Btn" >저장</button>
                    <button type="button" class="btn btn-secondary " data-bs-dismiss="modal">닫기</button>

                </div>
            </div>
        </div>
    </div>
<!-- 급여수정내역 모달 -->
<!-- 인쇄모달 -->
    <div class="modal fade" id="payrollPrintModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">급여명세서</h5>

                </div>
                <div class="modal-body">
<!-- 인쇄내용시작 -->
<div id="zzz">
  <h1>급여명세서</h1>
  <div>
  <span>2024.11 </span>
  <span></span>
  </div>
  <br>
  <table>
      <tr>
        <td class="background-payment">성명</td>
        <td colspan="3"></td>
        <td class="background-payment">사번</td>
        <td></td>
      </tr>
      <tr>
        <td class="background-payment">직급</td>
        <td colspan="3"></td>
        <td class="background-payment">부서</td>
        <td></td>
      </tr>
      <tr>
        <td class="background-payment">생년월일</td>
        <td colspan="3"></td>
        <td class="background-payment">지급일</td>
        <td></td>
      </tr>
  </table>
<br>
<br>
<table>
  <thead>
    <tr>
      <td colspan="2" class="bold-color">임금지급내역</td>
      <td colspan="2" class="bold-color">공제내역</td>
    </tr>
    <tr>
      <td class="background-payment">임금항목</td>
      <td class="background-payment">지급액원(원)</td>
      <td class="background-payment">공제항목</td>
      <td class="background-payment">지급액원(원)</td>
    </tr>
  </thead>
  <tbody>
    <tr>

    </tr>
  </tbody>
  <tfoot>
    <tr>
      <td class="background-payment">총지급액</td>
      <td></td>
      <td class="background-payment">총공제액</td>
      <td></td>
    </tr>
    <tr>
      <td class="background-payment">실지급액</td>
      <td colspan="3"></td>
    </tr>
  </tfoot>
</table> 
  <br>
  <table>
    <tr>
      <td colspan="3" class="bold-color">계산방법</td>
    </tr>
    <tr>
      <td class="background-payment">구분</td>
      <td class="background-payment">산출식 또는 산출방법</td>
      <td class="background-payment">지급액(원)</td>
    </tr>
    <tr>
      <td class="background-payment">연장근로수당</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td class="background-payment">야간근로수당</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td class="background-payment">주말근로수당</td>
      <td></td>
      <td></td>
    </tr>
  </table>
</div>

<!-- 인쇄내용끝 -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">인쇄</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                </div>
            </div>
        </div>
    </div>
<!-- 인쇄모달끝!!! -->

	<script th:src='@{/js/common/deleteRowBtn.js}'></script>	
	<script th:inline="javascript">
		const Grid = tui.Grid;
	    const grid = new tui.Grid({
	        el: document.getElementById('grid'),
	        width:1500,
	        rowHeaders: [
	            {
	              type: 'checkbox',
	              header: `
	                <span class="custom-input">
	                <input type="checkbox" id="all-checkbox" class="hidden-input" name="_checked" />
	              	<label for="all-checkbox" class="checkbox selectCheck">✔</label>
	            	</span>
	            `,
	              renderer: {
	                type: gridCheckbox
	              }
	            }
	          ],
	        scrollX: true,
	        scrollY: false,
	        columns: [
	          {
	        	  header:'급여명세번호',
	        	  name:'salaryNumber',
	        	  hidden:true
	          },
	          {
	            header: '귀속연월',
	            name: 'payrollYdate'
	          },
	          {
	        	header:'사원아이디',
	        	name:'employeeId'
	          },
	          {
	        	header:'성명',
	        	name:'name'
	          },
	          {
	            header: '기본급',
	            name: 'monthlySalary',
            	formatter: function (e) {
                    const value = e.value !== undefined && e.value !== null ? e.value : 0; // 기본값 0
                    return Number(value).toLocaleString() + "원"; // 숫자로 변환 후 포맷팅
                  },
	          },
	          {
	        	header:'연장수당',
	        	name:'overtimeAllowance',
	            formatter: function (e) {
	  		          const value = e.value !== undefined && e.value !== null ? e.value : 0; // 기본값 0
	  		          return Number(value).toLocaleString() + "원"; // 숫자로 변환 후 포맷팅
	  		    },
	        	
	          },
	          {
		        header:'야간수당',
		        name:'nightAllowance',
                formatter: function (e) {
		  		          const value = e.value !== undefined && e.value !== null ? e.value : 0; // 기본값 0
		  		          return Number(value).toLocaleString() + "원"; // 숫자로 변환 후 포맷팅
		  		    },
		      },
	          {
	            header: '주말근무수당',
	            name: 'weekendAllowance',
	            formatter: function (e) {
		  		          const value = e.value !== undefined && e.value !== null ? e.value : 0; // 기본값 0
		  		          return Number(value).toLocaleString() + "원"; // 숫자로 변환 후 포맷팅
	  		    },
	          },
		      {
		        header: '지급총액',
		        name: 'paymentTotal',
	            formatter: function (e) {
		  		          const value = e.value !== undefined && e.value !== null ? e.value : 0; // 기본값 0
 		          return Number(value).toLocaleString() + "원"; // 숫자로 변환 후 포맷팅
	  		    },
	          },
		      {
		        header: '소득세',
		        name: 'incomeTax',
	            formatter: function (e) {
		  		          const value = e.value !== undefined && e.value !== null ? e.value : 0; // 기본값 0
		  		          return Number(value).toLocaleString() + "원"; // 숫자로 변환 후 포맷팅
	  		    },
	          },
		      {
		        header: '지방세',
		        name: 'localTax',
	            formatter: function (e) {
  		          const value = e.value !== undefined && e.value !== null ? e.value : 0; // 기본값 0
  		          return Number(value).toLocaleString() + "원"; // 숫자로 변환 후 포맷팅
	  		    },
	          },
		      {
		        header: '국민연금',
		        name: 'nationalInsurance',
		        formatter: function (e) {
		  		const value = e.value !== undefined && e.value !== null ? e.value : 0; // 기본값 0
		  		return Number(value).toLocaleString() + "원"; // 숫자로 변환 후 포맷팅
	  		    },
	          },
		      {
		        header: '건강보험료',
		        name: 'healthInsurance',
	            formatter: function (e) {
	  		     const value = e.value !== undefined && e.value !== null ? e.value : 0; // 기본값 0
	  		     return Number(value).toLocaleString() + "원"; // 숫자로 변환 후 포맷팅
		      },

	          },
		      {
		        header: '고용보험료',
		        name: 'employmentInsurance',
	            formatter: function (e) {
	  		    const value = e.value !== undefined && e.value !== null ? e.value : 0; // 기본값 0
	  		     return Number(value).toLocaleString() + "원"; // 숫자로 변환 후 포맷팅
		    },
		        
	          },
		      {
		        header: '공제금액',
		        name: 'deductionsTotal',
	            formatter: function (e) {
	  		     const value = e.value !== undefined && e.value !== null ? e.value : 0; // 기본값 0
	  		     return Number(value).toLocaleString() + "원"; // 숫자로 변환 후 포맷팅
		    },
		        
	          },
		      {
		        header: '실지급액',
		        name: 'realPay',
		        formatter: function (e) {
		  		const value = e.value !== undefined && e.value !== null ? e.value : 0; // 기본값 0
		  		return Number(value).toLocaleString() + "원"; // 숫자로 변환 후 포맷팅
	  		    },
		        
	          }
	        ],
	    	data:[[${list}]]
	      });
	    
	</script>
	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
	<script th:src='@{/js/human/modal/payrollPrintModal.js}'></script>	
	<script th:src='@{/js/human/modal/salModifyModal.js}'></script>
	<script th:src="@{/js/human/paymentList.js}"></script>
</body>
</html>